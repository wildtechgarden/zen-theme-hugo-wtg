{{ define "main" -}}
<main class="main layout__main">
<article class="single-view{{ with .Section }} single-view--{{ . | urlize }}{{ end }}">
<header>
<h1 class="title {{ if $.Param "submitted" | default false }}mb--xxs{{ end }}">{{ .Title }}</h1>
{{ if $.Param "submitted" | default false }}{{ partial "submitted.html" . }}{{ end -}}
{{ if .Params.tags }}{{ partial "tags.html" . }}{{ end -}}
</header>
<div class="content">
{{ if and (.Param "toc") (not (.HasShortcode "details-toc")) }}
<details>
  <summary>What is in this article</summary>
  <div class="toc">
  {{- .Page.TableOfContents -}}
  </div>
</details>
{{ end }}
{{ .Content }}
</div>

{{ $pctx := . }}
{{ with .Param "page_endnote" -}}
<div class="content content--endnote">
{{ . | $pctx.RenderString }}
</div>
{{ end -}}

<div class="content content--bottom">
{{ if $.Param "relatedposts" | default false }}{{ partial "related.html" . }}{{ end -}}

{{ if ne .Lastmod .PublishDate }}{{ partial "dates.html" . }}{{ end -}}
</div>
</article>
</main>
{{ end }}
